<view class="container">
  <view class="question" bind:tap="closeMenu">
    <view class="questionInfo">
      <view class="process">
        <progress percent="{{(currentIndex + 1) * 100 /totalData}}" strokeWidth="8" active activeColor="#3a448a" borderRadius="16" class="{{item.percent == 50 ? 'progress50' : 'progress90'}}" active-mode="forwards"></progress>
        <text>{{currentIndex + 1}}/{{totalData}}</text>
      </view>

      <view class="mode-class">
        <text>背题</text>
        <switch class="wx-switch-input" checked="true" bindchange="switchMode" color="#1569E4"/>
        <text>刷题</text>
      </view>
    </view>
    <view class="tags" wx:if="{{tags.length > 0 && tags[0].length > 0}}">
      <block wx:for="{{tags}}" wx:key="index">
        <view wx:if="{{item.length > 0}}" class="box-bound">
          {{item}}推荐
        </view>
      </block>
    </view>
    <view class="questionTexts">
      <wemark md="{{questionData[indexList[currentIndex]].question}}" link highlight type="wemark"></wemark>
    </view>
    <view wx:if="{{questionData[indexList[currentIndex]].question_img.length != 0}}" style="width: 80%; height: {{questionImageHeight}}rpx; overflow: hidden;">
      <image src="{{questionData[indexList[currentIndex]].question_img}}" bindload="onQuestionImageLoad" mode="aspectFit" style="width: 100%; height: 100%;"/>
    </view>
  </view>

  <view class="options" bind:tap="closeMenu">
    <!-- 假设选项格式为 "a,b,c,d,e"，以逗号分隔 -->
    <block wx:for="{{options}}" wx:key="index">
      <view wx:if="{{showComments || mode}}" class="option {{item.selected}}" data-index="{{index}}" bindtap="selectOption">
        <wemark md="{{item.text}}" link highlight type="wemark"></wemark>
        <!-- <text class="optionText">{{item.text}}</text> -->
      </view>
      <view class="option" data-index="{{index}}" bindtap="selectOption" wx:else="{{showComments || mode}}">
        <wemark md="{{item.text}}" link highlight type="wemark"></wemark>
        <!-- <text class="optionText">{{item.text}}</text> -->
      </view>
    </block>
  </view>

  <view class="icons">
    <view class="like">
      <image wx:if="{{favor_state == 0 || favor_state == 2}}" class="sm-icon" src="/images/dianzan.png" mode="" bind:tap="likeQuestion"/>
      <image wx:if="{{favor_state == 1}}" class="sm-icon" src="/images/dianzaned.png" mode="" bind:tap="likeQuestion"/>
      {{favors}}
      <image wx:if="{{favor_state == 0 || favor_state == 1}}" class="sm-icon" src="/images/diancai.png" mode="" bind:tap="dislikeQuestion"/>
      <image wx:if="{{favor_state == 2}}" class="sm-icon" src="/images/diancaied.png" mode="" bind:tap="dislikeQuestion"/>
      {{disfavors}}
    </view>
    <view class="right-icon">
      <image class="favorQuestion" bind:tap="favorQuestion" src="{{favor? '/images/favor_exams.png' : '/images/favor_exam.png'}}" mode=""/>
      <image src="/images/icon_listed@3x.png" mode="" bind:tap="swicthMenu" class="listQuestion"/>
      <image class="foreQuestion" bind:tap="foreQuestion" src="/images/last.png" mode=""/>
      <image class="nextQuestion" bind:tap="nextQuestion" src="/images/next.png" mode=""/>
    </view>
  </view>

  <view class="comments" wx:if="{{showComments || mode}}">
    <view class="borders">
      <view class="feeds">
        <view>
          <view class="correct answers">正确答案：{{answer}}</view><view class=" answers {{answer === userAnswer ? 'correct' : 'wrong'}}">你的答案：{{userAnswer}}</view>
        </view>
        <view class="feedback" bind:tap="showModal"><image src="/images/feedback.png" class="icon" mode=""/>题目反馈</view>
      </view>
      <view>本题正确率：{{currentRate}}%</view>
    </view>
    <view class="separator"></view>
    <view class="borders">
      <wemark md="{{questionData[questionIndex].comments}}" link highlight type="wemark"></wemark>
    </view>
  </view>
  <view wx:if="{{(showComments || mode) && questionData[indexList[currentIndex]].comment_img.length != 0}}" class="commentsimg">
    <image bindload="onCommentImageLoad" src="{{questionData[indedxList[currentIndex]].comment_img}}" mode="aspectFit" style="width: 80%; height: {{commentImageHeight}}rpx;"/>
  </view>
  
  <view class="knowledge-points" wx:if="{{showComments || mode}}">
    <view class="title">相关信息</view>
    <view wx:if="{{point_name.length != 0}}" class="points">
      <text class="point-name">{{point_name}}</text>
    </view>
    <view wx:if="{{origin_time.length != 0}}" class="points">
      <text class="point-name">{{origin_time}}</text>
    </view>
    <view class="borders">
    </view>
  </view>

  <view class="knowledge-points" wx:if="{{showComments || mode}}">
    <view class="title">我的反馈</view>
    <view wx:if="{{feedback.length != 0}}" class="feed-area">
      <text class="feedback-name">{{feedback}}</text>
    </view>
    <view wx:else="{{feedback.length != 0}}" class="feed-area">
      <text class="feedback-name">暂无反馈</text>
    </view>
    <view class="borders">
    </view>
  </view>
  
  <view style="height:270rpx; width:200rpx;"></view>
  <feedbackInput wx:if="{{showModal}}" showModal="{{showModal}}" bindconfirm="handleConfirm" bindcloseModal="handleCloseModal"></feedbackInput>
</view>
<view style="width: 10%; height: 40rpx;"></view>
<view wx:if="{{showTable}}" class="control">
  <view class="menus">
    <image src="/images/close.png" class="close-btn" mode="" bind:tap="swicthMenu"/>
    <scroll-view scroll-y="true" class="info-con">
      <view class="answer-container">
        <block wx:for="{{questionData}}" wx:key="index" wx:for-index="key" wx:for-item="value">
          <view class="exam-info {{value.class}} {{value.index-1 === currentIndex ? 'current' : 'null'}}" bind:tap="switchExam" data-index="{{value.index}}">{{value.index}}</view>
          <view wx:if="{{(index + 1) % 6 === 0}}" class="line-break"></view>
        </block>
      </view>
    </scroll-view>
    <view class="example">
      <view class="example-icon unanswered">未答</view>
      <view class="example-icon trueAnswer">正确</view>
      <view class="example-icon wrongAnswer">错误</view>
      <view class="example-icon current">当前题</view>
    </view>
  </view>
</view>
<!-- <view wx:else="{{showTable}}" class="menu-btn" bind:tap="swicthMenu">答题卡片</view> -->
